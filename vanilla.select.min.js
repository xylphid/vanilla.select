/**
 * Vanilla select ;) (https://github.com/xylphid)
 * Version 1.0.1
 *
 * @author Anthony PERIQUET
 */
 !function(e,l){currentSelect=null,vanilla.select=function(e,l){if(!(this instanceof vanilla.select))return new vanilla.select(e,l);currentSelect=self=this,self.options=vanilla.extend({},vanilla.select.defaults,l),self.query=e,void 0!==e&&(self.items=vanilla(e)),self.__init__()},vanilla.select.prototype={contructor:vanilla.select,__init__:function(){self.items.each(function(e){self.beautify(e)}),l.removeEventListener("click",self._bindSelect,!1),l.addEventListener("click",self._bindSelect,!1)},_bindSelect:function(e){var l=e.target;if(vanilla.is(l,".vanilla-select > label"))self.show(l.parentNode);else if(vanilla.is(l,".vanilla-select > .options > label"));else if(vanilla.is(l,".vanilla-select > .options > label > input")){var t=vanilla(l.parentNode).parent().parent();self._setSelected(l.parentNode),self._updatePlaceholder(t)}else{for(;l&&"vanilla-select"!=l.className;)l=l.parentNode;l?self.show(l):self.close()}},_setSelected:function(e){var l=vanilla(e).toggleClass("selected").children("input").toggleAttr("checked","checked"),t=vanilla(e).parent().parent().prev();t.children().each(function(a){var n=void 0!==a.attr("value")?a.attr("value"):a.html();n==l.value()?a.toggleAttr("selected","selected"):void 0===t.attr("multiple")&&(vanilla(e).parent().children('* > [value="'+n+'"]').attr("checked",null).parent().removeClass("selected"),a.attr("selected",null))}),void 0===t.attr("multiple")&&self.close()},show:function(e){e=vanilla(e),vanilla(".vanilla-select.opened").each(function(l){l.nodes[0]!=e.nodes[0]&&l.toggleClass("opened")}),e.toggleClass("opened")},close:function(){vanilla(".vanilla-select").each(function(e){e.removeClass("opened")})},beautify:function(e){var l=vanilla("<div>").addClass("vanilla-select");e.outerWidth()>parseInt(l.css("width"))&&(l.css("width",e.outerWidth()+"px"),l.css("flex-basis",e.outerWidth()+"px")),e.css("display","none"),self._setPlaceholder(l,e),self._setOptions(l,e),e.after(l)},_updatePlaceholder:function(e){e.firstChild().remove(),self._setPlaceholder(e,e.prev())},_setPlaceholder:function(e,l){var t=l.children("[selected]"),a=vanilla("<label>");if(t.length()){var n=[];t.each(function(e){n.push(e.html())}),a.attr("title",n.join(", ")),a.html(t.length()<=self.options.placeholder.maxLength?n.join(", "):String.format(self.options.placeholder.overflow,t.length()))}else a.html(self.options.placeholder.empty);e.prepend(a)},_setOptions:function(e,l){var t=vanilla("<div>").addClass("options");l.children().each(function(e){var a=void 0!==e.attr("value")?e.attr("value"):e.html(),n=vanilla("<label>").addClass("option").html(e.html()),i=vanilla("<input />").attr("type","checkbox").attr("value",a);void 0===l.attr("multiple")&&i.addClass("hidden"),e.is("[selected=selected]")&&(n.addClass("selected"),i.attr("checked","checked")),i.prependTo(n),t.append(n)}),e.append(t)}},vanilla.select.defaults={placeholder:{maxLength:2,empty:"No selection",overflow:"{0} items selected"}},String.format=function(){for(var e=arguments[0],l=0;l<arguments.length-1;l++){var t=new RegExp("\\{"+l+"\\}","gm");e=e.replace(t,arguments[l+1])}return e},vanilla.prototype.select=function(e){return this instanceof vanilla&&(currentSelect=new vanilla.select(this,e)),this},vanilla(l).ready(function(){vanilla("select.beautify").select()})}(window,document);